{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sameer/code/picovoice/product_ratings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/sameer/code/picovoice/product_ratings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/sameer/code/picovoice/product_ratings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sameer/code/picovoice/product_ratings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import CardList from'../components/CardList';import'./App.css';import db from'./firebase.config.js';import axios from'axios';function App(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),ratings=_useState6[0],setRatings=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),searchResults=_useState8[0],setSearchResults=_useState8[1];var handleChange=function handleChange(event){setSearchTerm(event.target.value);};var fetchRatings=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://fetch ratings data from Firebase with hook\nresponse=db.collection('ratings');_context.next=3;return response.get();case 3:data=_context.sent;data.docs.forEach(function(item){setRatings(function(ratings){return[].concat(_toConsumableArray(ratings),[item.data()]);});});case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchRatings(){return _ref.apply(this,arguments);};}();useEffect(function(){//fetch mock data with hook\nvar fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios('https://jsonplaceholder.typicode.com/users');case 2:result=_context2.sent;setData(result.data);setSearchResults(result.data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();},[]);useEffect(function(){//search functionality\nfetchRatings();var results=data.filter(function(robot){return robot.name.toLowerCase().includes(searchTerm);});setSearchResults(results);},[data,searchTerm]);var postRating=function postRating(index,newValue){//POST to firebase, passed down to each product card\nvar key=\"rating-\"+index;var obj={};obj[key]=newValue;db.collection(\"ratings\").doc(\"oEQub6pDG6nK27mizA66\").update(obj).then(function(){console.log(\"Value successfully written!\");//To do: clearly indicate a changes to user by adding alert|banner for when a product rating is successfully updated\n}).catch(function(error){console.error(\"Error writing Value: \",error);});};return!data.length&&!ratings.length?/*#__PURE__*/React.createElement(\"h1\",null,\"Loading\"):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"tc\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"f1\"},\"Product Ratings: Robots\"),/*#__PURE__*/React.createElement(\"div\",{className:\"pa2\"},/*#__PURE__*/React.createElement(\"input\",{className:\"pa3 ba b--green bg-lightest-blue\",type:\"text\",placeholder:\"search robots\",value:searchTerm,onChange:handleChange})),/*#__PURE__*/React.createElement(CardList,{robots:searchResults,ratings:ratings,postRating:postRating})));}export default App;","map":{"version":3,"sources":["/Users/sameer/code/picovoice/product_ratings/src/containers/App.js"],"names":["React","useState","useEffect","CardList","db","axios","App","searchTerm","setSearchTerm","data","setData","ratings","setRatings","searchResults","setSearchResults","handleChange","event","target","value","fetchRatings","response","collection","get","docs","forEach","item","fetchData","result","results","filter","robot","name","toLowerCase","includes","postRating","index","newValue","key","obj","doc","update","then","console","log","catch","error","length"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\nimport CardList from '../components/CardList';\nimport './App.css';\nimport db from './firebase.config.js';\nimport axios from 'axios';\n\nfunction App() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [data, setData] = useState([]);\n  const [ratings, setRatings] = useState([]);\n  const [searchResults, setSearchResults] = useState([]);\n  const handleChange = event => {\n    setSearchTerm(event.target.value);\n  };\n\n  const fetchRatings=async()=>{ //fetch ratings data from Firebase with hook\n    const response=db.collection('ratings');\n    const data=await response.get();\n    data.docs.forEach(item=>{\n     setRatings(ratings=> [...ratings,item.data()]);\n    });\n  }\n\n  useEffect(() => { //fetch mock data with hook\n    const fetchData = async () => {\n      const result = await axios(\n        'https://jsonplaceholder.typicode.com/users',\n      ); \n      setData(result.data);\n      setSearchResults(result.data)\n    };\n \n    fetchData();\n  }, []);\n\n  useEffect(() => { //search functionality\n    fetchRatings();\n    const results = data.filter(robot =>\n      robot.name.toLowerCase().includes(searchTerm)\n    );\n    setSearchResults(results);\n  }, [data, searchTerm]);\n  \n  const postRating = (index,newValue) => { //POST to firebase, passed down to each product card\n    const key = \"rating-\"+index;\n    var obj = {};\n    obj[key]=newValue;\n    db.collection(\"ratings\")\n      .doc(\"oEQub6pDG6nK27mizA66\")\n      .update(obj)\n      .then(function () {\n        console.log(\"Value successfully written!\",);\n        //To do: clearly indicate a changes to user by adding alert|banner for when a product rating is successfully updated\n      })\n      .catch(function (error) {\n        console.error(\"Error writing Value: \", error);\n      });\n  }\n\n  return ( (!data.length && !ratings.length) ?\n    <h1>Loading</h1> :\n    <div>\n      <div className='tc'>\n        <h1 className='f1'>Product Ratings: Robots</h1>\n        <div className='pa2'>\n          <input\n            className='pa3 ba b--green bg-lightest-blue'\n            type='text'\n            placeholder='search robots'\n            value={searchTerm}\n            onChange={handleChange}\n          />\n      </div>\n          <CardList robots={searchResults} ratings={ratings} postRating={postRating}/>\n      </div>\n    </div>\n  );\n\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}